<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <title>ShopStreet</title>
        <script src="libs/js/aframe/aframe-1.0.4.min.js"></script>
        <script src="libs/js/aframe/physics-system/aframe-physics-system-4.0.1.min.js"></script>
        <script src="libs/js/aframe/extra/aframe-extra-6.1.0.min.js"></script>
        <script src="libs/js/aframe/room-component/room-component.min.js"></script>
        <script src="libs/js/aframe/teleport-controls/aframe-teleport-controls.min.js"></script>
        <script src="libs/js/aframe/environment-component/aframe-environment-component.min.js"></script>

        <script src="js/functions.js"></script>
        
        <script src="js/components/RaycasterListener.js"></script>
        <script src="js/components/RightHandListener.js"></script>
        <script src="js/components/LeftHandListener.js"></script>
        
        <script src="js/components/polygon.js"></script>
        <script src="js/components/meteo.js"></script>
    </head>
    <body>
        <a-scene physics="debug: false" meteo
                 renderer="colorManagement: true">
            <a-assets>
                <a-asset-item id="temple-obj" src="models/tample/Mausoleum.obj"></a-asset-item>
                <a-asset-item id="temple-mtl" src="models/tample/Mausoleum.mtl"></a-asset-item>

                <a-asset-item id="building-obj" src="models/immeuble/Building.obj"></a-asset-item>
                <a-asset-item id="building-mtl" src="models/immeuble/Building.mtl"></a-asset-item>
                <a-asset-item id="building-gltf" src="models/immeuble/Building.gltf"></a-asset-item>

                <audio id="river" src="sources/audio/riviÃ¨re.mp3"></audio>
                <img id="water-normal"
                     src="https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/waternormals.jpg"
                     crossorigin="anonymous"  alt="water mesh"/>

                <a-mixin id="floorMat" material="color:#BBB"></a-mixin>
                <img id="testTex" src="https://omgitsraven.github.io/aframe-room-component/examples/basic/test.png">
            </a-assets>

            <!-- Player -->
            <a-entity id="rig"
                      movement-controls kinematic-body
                      position="-4 1.6 0"
                      rotation="0 -90 0"
                      collide-listener>
                <a-entity id="camera"
                          camera="userHeight: 1.6" position="0 1.6 0"
                          width="0.1" height="0.1" depth="0.1"
                          look-controls="pointerLockEnabled: true"></a-entity>

                <a-entity id="left-hand"
                          hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"
                          teleport-controls="cameraRig: #rig; teleportOrigin: #camera; button: grip; type: line;"
                          left-hand-listener></a-entity>
                <a-entity id="right-hand"
                          hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc"
                          teleport-controls="cameraRig: #rig; teleportOrigin: #camera; button: grip; type: line"
                          right-hand-listener></a-entity>
            </a-entity>

            <!-- Ground -->
            <a-grid static-body></a-grid>
            <a-plane width="100" height="100"
                     color="#94d82d"
                     position="0 0.1 0" rotation="-90 0 0"
                     static-body
                     class="links"></a-plane>
            <a-sky color="skyblue"></a-sky>

            <a-box color="#39BB82" class="links"
                   width="15" height="5" depth="3"
                   position="-28 2.5 -5"
                   static-body></a-box>
            <a-box color="#39BB82" class="links"
                   width="15" height="5" depth="3"
                   position="28 2.5 5"
                   static-body></a-box>
            <a-box color="yellow" class="links"
                   width="15"  height="5" depth="3"
                   position="-28 0 10"
                   rotation="45 0 0"
                   static-body></a-box>

            <a-text value="Hello World !!" negate="false"
                    position="-28 2 -4"></a-text>

            <a-entity position="-20 0 -2"
                      rotation="0 0 -30"
                      width="1" height="1" depth="1"
                      class="links"
                      polygon static-body>
            </a-entity>

            <a-box obj-model="obj: #temple-obj; mtl: #temple-mtl"
                   scale="0.05 0.05 0.05"
                   rotation="0 90 0"
                   position="-28 5 20"
                   static-body></a-box>

            <!--<a-box width="10" height="10" depth="10"
                   position="-20 5 20"
                   rotation="90 0 0"
                   static-body>
                <a-entity gltf-model="#building-gltf" scale="1.5 1.5 1.5" ></a-entity>
            </a-box>-->

            <rw-room position="-2.5 0 -2.5" width="5" length="5" height="3">

                <a-box width="1.5" height="6" position="1 0 -0.1" depth="0.05" static-body></a-box>
                <a-box width="0.5" height="6" position="4.5 0 -0.1" depth="0.05" static-body></a-box>
                <rw-wall material="color:#F88">

                    <rw-doorhole id="holeA"></rw-doorhole>

                </rw-wall>

                <a-box width="5" height="6" position="5.2 0 2.4" rotation="0 90 0" depth="0.05" static-body></a-box>
                <rw-wall material="color:#F88"></rw-wall>

                <a-box width="1.5" height="6" position="0.5 0 5.2" depth="0.05" static-body></a-box>
                <a-box width="1.5" height="6" position="4.5 0 5.2" depth="0.05" static-body></a-box>
                <rw-wall material="color:#F88">

                    <rw-doorhole id="frontInner"></rw-doorhole>

                </rw-wall>

                <a-box width="5" height="6" position="-0.2 0 2.5" rotation="0 90 0" depth="0.05" static-body></a-box>
                <rw-wall material="color:#F88"></rw-wall>

                <rw-floor mixin="floorMat"></rw-floor>
                <rw-ceiling material="color:#AAA"></rw-ceiling>

            </rw-room>

            <rw-doorlink position="0.5 0 0" from="#holeA" to="#holeB" width="2">

                <rw-floor mixin="floorMat"></rw-floor>
                <rw-ceiling material="color:#BB6"></rw-ceiling>
                <rw-sides material="color:#BB6"></rw-sides>

            </rw-doorlink>

            <rw-room position="0 0 -2.7">

                <a-box width="5" height="6" position="-2.4 0 -2.5" rotation="0 90 0" depth="0.05" static-body></a-box>
                <rw-wall position="-2 0 0" material="color:#F00"></rw-wall>
                <rw-wall position=" 2 0 0" material="src:#testTex; repeat:0.5 0.5;">

                    <rw-doorhole id="holeB"></rw-doorhole>

                </rw-wall>
                <rw-wall position=" 2 0 -5" material="color:#00F">

                    <rw-doorhole id="holeC"></rw-doorhole>
                    <rw-doorlink from="#holeC" to="#holeD" position="4 0 0"></rw-doorlink>

                </rw-wall>

                <a-box width="3.5" height="6" position="0 0 -5.1" depth="0.05" static-body></a-box>
                <rw-wall position="-2 0 -5" material="color:#F0F">

                    <a-box position="0.5 1.4 0" scale="0.5 0.5 0.2"></a-box>
                    <a-box position="1.5 1.7 0" scale="0.5 0.5 0.2"></a-box>
                    <a-box position="2.5 1.4 0" scale="0.5 0.5 0.2"></a-box>

                </rw-wall>

                <rw-floor mixin="floorMat"></rw-floor>
                <rw-ceiling material="color:#99A"></rw-ceiling>

            </rw-room>

            <rw-room position="2 0 -5">

                <a-box width="0.8" height="6" position="0.5 0 -0.5" depth="0.05" static-body></a-box>
                <rw-wall position="0 0 0" material="color:#800"></rw-wall>

                <a-box width="2" height="6" position="0.2 0 -1.9" rotation="0 90 0" depth="0.05" static-body></a-box>
                <rw-wall position="0 0 2" material="color:#800">

                    <rw-doorhole id="holeD"></rw-doorhole>

                </rw-wall>
                <rw-wall position="1 0 2" material="color:#800"></rw-wall>

                <a-box width="2.5" height="6" position="1.2 0 1" rotation="0 90 0" depth="0.05" static-body></a-box>
                <rw-wall position="1 0 0" material="color:#800"></rw-wall>

                <rw-floor mixin="floorMat"></rw-floor>
                <rw-ceiling material="color:#99A"></rw-ceiling>

            </rw-room>

            <rw-room position="0 0 0" outside="true" material="color:#877">

                <rw-wall position="-3 0 -8" height="3"></rw-wall>
                <rw-wall position=" 4 0 -8" height="3"></rw-wall>
                <rw-wall position=" 4 0  3" height="3"></rw-wall>
                <rw-wall position="-3 0  3" height="3">
                    <rw-doorhole id="frontOuter"></rw-doorhole>

                    <rw-doorlink from="#frontInner" to="#frontOuter" material="color:#778" position="3 0 0">

                        <rw-floor></rw-floor>
                        <rw-ceiling></rw-ceiling>
                        <rw-sides></rw-sides>

                    </rw-doorlink>

                </rw-wall>

            </rw-room>

            <a-ocean-plane material="normalMap: #water-normal;"
                           geometry="width: 10; height: 100;"
                           position="-10 0.2 0"
                           sound="src: #river; autoplay: true; loop: true; positional: true; refDistance: 2; distanceModel: linear;"></a-ocean-plane>

        </a-scene>
    </body>
</html>
